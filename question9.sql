.mode table
.header on

SELECT BK.TITLE, BA.AUTHOR_NAME,CAST(
		CASE
			WHEN RETURNED_DATE IS NULL 
			THEN JULIANDAY('NOW') - JULIANDAY(BL.DATE_OUT)
			
			ELSE JULIANDAY(BL.RETURNED_DATE) - JULIANDAY(BL.DATE_OUT)
			END AS INTEGER)
	 			AS DAYS_BORROWED,
		
		CASE
			WHEN RETURNED_DATE IS NULL OR (JULIANDAY(BL.RETURNED_DATE) - JULIANDAY(BL.DUE_DATE))
			THEN 'YES'
			ELSE 'NO'
			END AS LATE_RETURNED

FROM BOOK BK NATURAL JOIN BOOK_AUTHORS BA 
NATURAL JOIN BOOK_LOANS BL
NATURAL JOIN BORROWER BR

WHERE BR.NAME = 'Ethan Martinez'
ORDER BY BL.DATE_OUT;




























